(function(h,v){typeof exports=="object"&&typeof module!="undefined"?v(exports):typeof define=="function"&&define.amd?define(["exports"],v):(h=typeof globalThis!="undefined"?globalThis:h||self,v(h.router={}))})(this,function(h){"use strict";var v=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function b(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var m={exports:{}};(function(c,_){(function(r){function s(e){var t=this;return this.events={},this.state=null,this.options=e||{},this.options.env=this.options.env||(Object.keys(r).length===0&&process&&process.browser!==!0?"server":"client"),this.options.mode=this.options.mode||(this.options.env!=="server"&&this.options.pushState&&r.history&&r.history.pushState?"pushState":"hashchange"),this.version="0.6.4",typeof r.addEventListener=="function"&&(r.addEventListener("hashchange",function(){t.trigger("hashchange")}),r.addEventListener("popstate",function(n){if(t.state&&t.state.previousState===null)return!1;t.trigger("navigate")})),this}s.regexRoute=function(e,t,n,i){return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(i?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,o,l,y,p,g){return t.push({name:y,optional:!!g}),o=o||"",""+(g?"":o)+"(?:"+(g?o:"")+(l||"")+(p||l&&"([^/.]+?)"||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",n?"":"i"))},s._forEach=function(e,t){return typeof Array.prototype.forEach=="function"?Array.prototype.forEach.call(e,t):function(n,i){for(var a=0,o=this.length;a<o;++a)n.call(i,this[a],a,this)}.call(e,t)},s.prototype.get=s.prototype.add=function(e){var t=this,n=Array.prototype.slice.call(arguments,1,-1),i=Array.prototype.slice.call(arguments,-1)[0],a=new d(e),o=function(){var p=a.parse(t.path());if(p.match){var g={route:e,params:p.params,req:p,regex:p.match},f=new u(t,g).enqueue(n.concat(i));if(t.trigger("match",f,p),!f.runCallback)return t;if(f.previousState=t.state,t.state=f,f.parent()&&f.parent().propagateEvent===!1)return f.propagateEvent=!1,t;f.callback()}return t},l=t.options.mode!=="pushState"&&t.options.env!=="server"?"hashchange":"navigate";return o().on(l,o)},s.prototype.trigger=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return this.events[e]&&s._forEach(this.events[e],function(i){i.apply(t,n)}),this},s.prototype.on=s.prototype.bind=function(e,t){var n=this,i=e.split(" ");return s._forEach(i,function(a){n.events[a]?n.events[a].push(t):n.events[a]=[t]}),this},s.prototype.once=function(e,t){var n=!1;return this.on(e,function(){return n?!1:(n=!0,t.apply(this,arguments),t=null,!0)})},s.prototype.context=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){var i=arguments[0],a=arguments.length>2?Array.prototype.slice.call(arguments,1,-1):[],o=Array.prototype.slice.call(arguments,-1)[0],l=e.slice(-1)!=="/"&&i!=="/"&&i!==""?e+"/":e,y=i.substr(0,1)!=="/"?i:i.substr(1),p=l+y;return t.add.apply(t,[p].concat(n).concat(a).concat([o]))}},s.prototype.navigate=function(e){return this.path(e).trigger("navigate")},s.prototype.path=function(e){var t=this,n;if(typeof e=="string")return t.options.mode==="pushState"?(n=t.options.root?t.options.root+e:e,r.history.pushState({},null,n)):r.location?r.location.hash=(t.options.hashBang?"!":"")+e:r._pathname=e||"",this;if(typeof e=="undefined")return t.options.mode==="pushState"?n=r.location.pathname.replace(t.options.root,""):t.options.mode!=="pushState"&&r.location?n=r.location.hash?r.location.hash.split(t.options.hashBang?"#!":"#")[1]:"":n=r._pathname||"",n;if(e===!1)return t.options.mode==="pushState"?r.history.pushState({},null,t.options.root||"/"):r.location&&(r.location.hash=t.options.hashBang?"!":""),t},s.listen=function(){var e,t;return arguments[0]&&arguments[1]?(e=arguments[0],t=arguments[1]):t=arguments[0],function(){for(var n in t)this.add.call(this,n,t[n]);return this}.call(new s(e||{}))};function u(e,t){this.stack=u.global.slice(0),this.router=e,this.runCallback=!0,this.callbackRan=!1,this.propagateEvent=!0,this.value=e.path();for(var n in t)this[n]=t[n];return this}function d(e){this.route=e,this.keys=[],this.regex=s.regexRoute(e,this.keys)}u.global=[],u.prototype.preventDefault=function(){this.runCallback=!1},u.prototype.stopPropagation=function(){this.propagateEvent=!1},u.prototype.parent=function(){var e=!!(this.previousState&&this.previousState.value&&this.previousState.value==this.value);return e?this.previousState:!1},u.prototype.callback=function(){this.callbackRan=!0,this.timeStamp=Date.now(),this.next()},u.prototype.enqueue=function(e,t){for(var n=Array.isArray(e)?t<e.length?e.reverse():e:[e];n.length;)this.stack.splice(t||this.stack.length+1,0,n.shift());return this},u.prototype.next=function(){var e=this;return this.stack.shift().call(this.router,this.req,this,function(){e.next.call(e)})},d.prototype.parse=function(e){var t=e.match(this.regex),n=this,i={params:{},keys:this.keys,matches:(t||[]).slice(1),match:t};return s._forEach(i.matches,function(a,o){var l=n.keys[o]&&n.keys[o].name?n.keys[o].name:o;i.params[l]=a?decodeURIComponent(a):void 0}),i},s.CallStack=u,s.Request=d,typeof r.define=="function"&&!r.define.amd.grapnel?r.define(function(e,t,n){return r.define.amd.grapnel=!0,s}):c.exports=s}).call({},typeof window=="object"?window:v)})(m);var S=m.exports;const w=b(S);h.default=w,Object.defineProperties(h,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
