(function(f,g){typeof exports=="object"&&typeof module!="undefined"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(f=typeof globalThis!="undefined"?globalThis:f||self,g(f.router={}))})(this,function(f){"use strict";var g=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function m(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var d={};(function(c){(function(i){function r(t){var e=this;this.options=t||{},this.options.env=this.options.env||"server",this.options.mode=this.options.mode||(this.options.env!=="server"&&this.options.pushState&&i.history&&i.history.pushState?"pushState":"hashchange"),typeof i.addEventListener=="function"&&(i.addEventListener("hashchange",function(){e.trigger("hashchange")}),i.addEventListener("popstate",function(n){if(e.state&&e.state.previousState===null)return!1;e.trigger("navigate")}))}r.prototype.events={},r.prototype.state=null,r.regexRoute=function(t,e,n,s){return t instanceof RegExp?t:(t instanceof Array&&(t="("+t.join("|")+")"),t=t.concat(s?"":"/?").replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,o,h,l,v,u){return e.push({name:l,optional:!!u}),o=o||"",""+(u?"":o)+"(?:"+(u?o:"")+(h||"")+(v||h&&"([^/.]+?)"||"([^/]+?)")+")"+(u||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)"),new RegExp("^"+t+"$",n?"":"i"))},r._forEach=function(t,e){return typeof Array.prototype.forEach=="function"?Array.prototype.forEach.call(t,e):function(n,s){for(var a=0,o=this.length;a<o;++a)n.call(s,this[a],a,this)}.call(t,e)},r.prototype.get=r.prototype.add=function(t){var e=this,n=Array.prototype.slice.call(arguments,1,-1),s=Array.prototype.slice.call(arguments,-1)[0],a=new y(t),o=function(){var l=a.parse(e.path());if(l.match){var v={route:t,params:l.params,req:l,regex:l.match},u=new p(e,v).enqueue(n.concat(s));if(e.trigger("match",u,l),!u.runCallback)return e;if(u.previousState=e.state,e.state=u,u.parent()&&u.parent().propagateEvent===!1)return u.propagateEvent=!1,e;u.callback()}return e},h=e.options.mode!=="pushState"&&e.options.env!=="server"?"hashchange":"navigate";return o().on(h,o)},r.prototype.trigger=function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return this.events[t]&&r._forEach(this.events[t],function(s){s.apply(e,n)}),this},r.prototype.on=r.prototype.bind=function(t,e){var n=this,s=t.split(" ");return r._forEach(s,function(a){n.events[a]?n.events[a].push(e):n.events[a]=[e]}),this},r.prototype.once=function(t,e){var n=!1;return this.on(t,function(){return n?!1:(n=!0,e.apply(this,arguments),e=null,!0)})},r.prototype.context=function(t){var e=this,n=Array.prototype.slice.call(arguments,1);return function(){var s=arguments[0],a=arguments.length>2?Array.prototype.slice.call(arguments,1,-1):[],o=Array.prototype.slice.call(arguments,-1)[0],h=t.slice(-1)!=="/"&&s!=="/"&&s!==""?t+"/":t,l=s.substr(0,1)!=="/"?s:s.substr(1),v=h+l;return e.add.apply(e,[v].concat(n).concat(a).concat([o]))}},r.prototype.navigate=function(t){return this.path(t).trigger("navigate")},r.prototype.path=function(t){var e=this,n;if(typeof t=="string")return e.options.mode==="pushState"?(n=e.options.root?e.options.root+t:t,i.history.pushState({},null,n)):i.location?i.location.hash=(e.options.hashBang?"!":"")+t:i._pathname=t||"",this;if(typeof t=="undefined")return e.options.mode==="pushState"?n=i.location.pathname.replace(e.options.root,""):e.options.mode!=="pushState"&&i.location?n=i.location.hash?i.location.hash.split(e.options.hashBang?"#!":"#")[1]:"":n=i._pathname||"",n;if(t===!1)return e.options.mode==="pushState"?i.history.pushState({},null,e.options.root||"/"):i.location&&(i.location.hash=e.options.hashBang?"!":""),e},r.listen=function(){var t,e;return arguments[0]&&arguments[1]?(t=arguments[0],e=arguments[1]):e=arguments[0],function(){for(var n in e)this.add.call(this,n,e[n]);return this}.call(new r(t||{}))};function p(t,e){this.stack=p.global.slice(0),this.router=t,this.runCallback=!0,this.callbackRan=!1,this.propagateEvent=!0,this.value=t.path();for(var n in e)this[n]=e[n];return this}function y(t){this.route=t,this.keys=[],this.regex=r.regexRoute(t,this.keys)}p.global=[],p.prototype.preventDefault=function(){this.runCallback=!1},p.prototype.stopPropagation=function(){this.propagateEvent=!1},p.prototype.parent=function(){var t=!!(this.previousState&&this.previousState.value&&this.previousState.value==this.value);return t?this.previousState:!1},p.prototype.callback=function(){this.callbackRan=!0,this.timeStamp=Date.now(),this.next()},p.prototype.enqueue=function(t,e){for(var n=Array.isArray(t)?e<t.length?t.reverse():t:[t];n.length;)this.stack.splice(e||this.stack.length+1,0,n.shift());return this},p.prototype.next=function(){var t=this;return this.stack.shift().call(this.router,this.req,this,function(){t.next.call(t)})},y.prototype.parse=function(t){var e=t.match(this.regex),n=this,s={params:{},keys:this.keys,matches:(e||[]).slice(1),match:e};return r._forEach(s.matches,function(a,o){var h=n.keys[o]&&n.keys[o].name?n.keys[o].name:o;s.params[h]=a?decodeURIComponent(a):void 0}),s},r.CallStack=p,r.Request=y,c.default=r})(typeof window=="object"?window:g)})(d);const _=m(d);f.default=_,Object.defineProperties(f,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
